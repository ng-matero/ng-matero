import{a as K,b as q}from"./chunk-D5MUOZBE.js";import{a as j,b as F,c as z}from"./chunk-TOPMHRN7.js";import{b as E,d as y,j as b}from"./chunk-JVECITTD.js";import{$e as G,Ac as J,Ba as w,Bb as h,Hb as _,Ib as P,M as B,Nb as U,Qa as d,Ra as e,Sa as i,T as u,Ta as S,Tf as M,Uf as D,Vf as $,W as x,Wf as W,X as f,Xe as k,Xf as L,_a as H,ab as c,ec as v,eg as R,f as Y,jf as I,lb as V,oa as o,qb as t,rb as g,ub as C,va as T,vb as O,wb as N}from"./chunk-PYJ7M2E6.js";var Z=(()=>{let s=class s{constructor(){this.rolesSrv=u(D),this.permissionsSrv=u(M),this.currentRole="",this.currentPermissions=[],this.permissionsOfRole={ADMIN:["canAdd","canDelete","canEdit","canRead"],MANAGER:["canAdd","canEdit","canRead"],GUEST:["canRead"]},this._destroy$=new Y}ngOnInit(){this.currentRole=Object.keys(this.rolesSrv.getRoles())[0],this.currentPermissions=Object.keys(this.permissionsSrv.getPermissions()),this.rolesSrv.roles$.pipe(B(this._destroy$)).subscribe(p=>{console.log(p)}),this.permissionsSrv.permissions$.pipe(B(this._destroy$)).subscribe(p=>{console.log(p)})}ngOnDestroy(){this._destroy$.next(),this._destroy$.complete()}onPermissionChange(){this.currentPermissions=this.permissionsOfRole[this.currentRole],this.rolesSrv.flushRolesAndPermissions(),this.rolesSrv.addRoleWithPermissions(this.currentRole,this.currentPermissions)}};s.\u0275fac=function(a){return new(a||s)},s.\u0275cmp=T({type:s,selectors:[["app-permissions-role-switching"]],decls:26,vars:7,consts:[["href","https://github.com/AlexKhymenko/ngx-permissions","target","_blank"],[3,"ngModelChange","change","ngModel"],["value","ADMIN"],["value","MANAGER"],["value","GUEST"]],template:function(a,r){a&1&&(S(0,"page-header"),e(1,"p"),t(2," The permissions management is powered by "),e(3,"a",0)(4,"code"),t(5,"ngx-permissions"),i()(),t(6,` .
`),i(),e(7,"mat-card")(8,"mat-card-content")(9,"mat-button-toggle-group",1),N("ngModelChange",function(m){return O(r.currentRole,m)||(r.currentRole=m),m}),c("change",function(){return r.onPermissionChange()}),e(10,"mat-button-toggle",2),t(11,"ADMIN"),i(),e(12,"mat-button-toggle",3),t(13,"MANAGER"),i(),e(14,"mat-button-toggle",4),t(15,"GUEST"),i()(),e(16,"p"),t(17," Your current role: "),e(18,"code"),t(19),_(20,"json"),i()(),e(21,"p"),t(22," Your current permissions: "),e(23,"code"),t(24),_(25,"json"),i()()()()),a&2&&(o(9),C("ngModel",r.currentRole),o(10),g(P(20,3,r.currentRole)),o(5),g(P(25,5,r.currentPermissions)))},dependencies:[I,k,G,z,j,F,b,E,y,R,v],encapsulation:2});let n=s;return n})();var ee=(()=>{let s=class s{constructor(){this.router=u(J),this.rolesSrv=u(D),this.permissionsSrv=u(M),this.currentRole="",this.currentPermissions=[],this.permissionsOfRole={ADMIN:["canAdd","canDelete","canEdit","canRead"],MANAGER:["canAdd","canEdit","canRead"],GUEST:["canRead"]}}ngOnInit(){this.currentRole=Object.keys(this.rolesSrv.getRoles())[0],this.currentPermissions=Object.keys(this.permissionsSrv.getPermissions())}onPermissionChange(){this.currentPermissions=this.permissionsOfRole[this.currentRole],this.rolesSrv.flushRolesAndPermissions(),this.rolesSrv.addRoleWithPermissions(this.currentRole,this.currentPermissions),this.router.navigateByUrl("/dashboard")}};s.\u0275fac=function(a){return new(a||s)},s.\u0275cmp=T({type:s,selectors:[["app-permissions-route-guard"]],decls:22,vars:7,consts:[[3,"ngModelChange","change","ngModel"],["value","ADMIN"],["value","MANAGER"],["value","GUEST"]],template:function(a,r){a&1&&(S(0,"page-header"),e(1,"p"),t(2,"The route will be redirected to dashboard after change permission."),i(),e(3,"mat-card")(4,"mat-card-content")(5,"mat-button-toggle-group",0),N("ngModelChange",function(m){return O(r.currentRole,m)||(r.currentRole=m),m}),c("change",function(){return r.onPermissionChange()}),e(6,"mat-button-toggle",1),t(7,"ADMIN"),i(),e(8,"mat-button-toggle",2),t(9,"MANAGER"),i(),e(10,"mat-button-toggle",3),t(11,"GUEST"),i()(),e(12,"p"),t(13," Your current role: "),e(14,"code"),t(15),_(16,"json"),i()(),e(17,"p"),t(18," Your current permissions: "),e(19,"code"),t(20),_(21,"json"),i()()()()),a&2&&(o(5),C("ngModel",r.currentRole),o(10),g(P(16,3,r.currentRole)),o(5),g(P(21,5,r.currentPermissions)))},dependencies:[I,k,G,z,j,F,b,E,y,R,v],encapsulation:2});let n=s;return n})();var A=()=>["admin"],se=()=>["guest"],re=()=>["adminnnnn"],oe=()=>[];function me(n,s){n&1&&(e(0,"p",11),t(1,"I should see it only admin"),i())}function ae(n,s){n&1&&(e(0,"p",11),t(1,"Usage on both only and except I should see it only admin"),i())}function le(n,s){n&1&&(e(0,"p",12),t(1,"I will see it only guest"),i())}function pe(n,s){n&1&&(e(0,"p",13),t(1,"I will see it except adminnnnn"),i())}function ce(n,s){n&1&&(e(0,"p",14),t(1,"I should see it except admin"),i())}function de(n,s){n&1&&(e(0,"div"),t(1,"Testing template"),i())}function ue(n,s){n&1&&(e(0,"div"),t(1,"Testing template"),i())}function ge(n,s){n&1&&(e(0,"p",15),t(1,"else block"),i())}function he(n,s){n&1&&(e(0,"p",16),t(1,"then block"),i())}function _e(n,s){n&1&&(e(0,"button"),t(1," This should be visible to admin or superadmin "),i())}function Pe(n,s){n&1&&(e(0,"button"),t(1,"WTF"),i())}var te=(()=>{let s=class s{constructor(){this.permissionsSrv=u(M),this.comparedPermission=["guest"]}getPermissions(){return Object.keys(this.permissionsSrv.getPermissions())}addPermission(){this.permissionsSrv.addPermission("admin",()=>new Promise((p,a)=>{setTimeout(()=>p(!0),2e3)}))}removePermission(){this.permissionsSrv.removePermission("admin")}unAuthorized(){console.log("unAuthorized")}authorized(){console.log("authorizes")}changeToAdmin(){this.comparedPermission=["admin"],console.log(this.comparedPermission)}changeToAnotherPermission(){this.comparedPermission=["awesome"],console.log(this.comparedPermission)}changeToGuest(){this.comparedPermission=["guest"],console.log(this.comparedPermission)}};s.\u0275fac=function(a){return new(a||s)},s.\u0275cmp=T({type:s,selectors:[["app-permissions-test"]],decls:41,vars:28,consts:[["a",""],["b",""],["type","danger"],[3,"click"],["permissions","",3,"ngxPermissionsOnly"],[3,"ngxPermissionsOnly","ngxPermissionsExcept"],["permissions","",3,"permissionsAuthorized","permissionsUnauthorized","ngxPermissionsExcept"],["permissions","",3,"ngxPermissionsExcept"],[4,"ngxPermissionsOnly","ngxPermissionsOnlyElse","ngxPermissionsOnlyThen"],[4,"ngxPermissionsExcept","ngxPermissionsExceptElse","ngxPermissionsExceptThen"],[4,"ngxPermissionsOnly"],[1,"bg-green-50","text-white"],[1,"bg-purple-50","text-white"],[1,"bg-orange-50","text-white"],[1,"bg-azure-50","text-white"],[1,"bg-azure-30","text-light"],[1,"bg-azure-90","text-dark"]],template:function(a,r){if(a&1){let l=H();S(0,"page-header"),e(1,"mat-card")(2,"mat-card-content")(3,"mtx-alert",2),t(4,"\u26A0\uFE0F The permissions check will delay 2s."),i(),e(5,"p")(6,"button",3),c("click",function(){return x(l),f(r.addPermission())}),t(7,"Add Permission [ admin ]"),i(),e(8,"button",3),c("click",function(){return x(l),f(r.removePermission())}),t(9,"Remove Permission [ admin ]"),i()(),w(10,me,2,0,"ng-template",4)(11,ae,2,0,"ng-template",5)(12,le,2,0,"ng-template",4)(13,pe,2,0,"ng-template",6),c("permissionsAuthorized",function(){return x(l),f(r.authorized())})("permissionsUnauthorized",function(){return x(l),f(r.unAuthorized())}),w(14,ce,2,0,"ng-template",7)(15,de,2,0,"div",8)(16,ue,2,0,"div",9)(17,ge,2,0,"ng-template",null,0,U)(19,he,2,0,"ng-template",null,1,U),e(21,"p"),t(22," Compared permission: "),e(23,"code"),t(24),_(25,"json"),i()(),e(26,"div")(27,"button",3),c("click",function(){return x(l),f(r.changeToAdmin())}),t(28,"Change To Admin Permission"),i(),e(29,"button",3),c("click",function(){return x(l),f(r.changeToAnotherPermission())}),t(30,"Change To Awesome Permission"),i(),e(31,"button",3),c("click",function(){return x(l),f(r.changeToGuest())}),t(32,"Change To Guest Permission"),i()(),e(33,"div"),w(34,_e,2,0,"button",10)(35,Pe,2,0,"button",10),i(),e(36,"p"),t(37," Your current permissions: "),e(38,"code"),t(39),_(40,"json"),i()()()()}if(a&2){let l=V(18),m=V(20);o(10),d("ngxPermissionsOnly",h(20,A)),o(),d("ngxPermissionsOnly",h(21,A))("ngxPermissionsExcept","hhhhh"),o(),d("ngxPermissionsOnly",h(22,se)),o(),d("ngxPermissionsExcept",h(23,re)),o(),d("ngxPermissionsExcept",h(24,A)),o(),d("ngxPermissionsOnly",h(25,A))("ngxPermissionsOnlyElse",l)("ngxPermissionsOnlyThen",m),o(),d("ngxPermissionsExcept",h(26,A))("ngxPermissionsExceptElse",l)("ngxPermissionsExceptThen",m),o(8),g(P(25,16,r.comparedPermission)),o(10),d("ngxPermissionsOnly",r.comparedPermission),o(),d("ngxPermissionsOnly",h(27,oe)),o(4),g(P(40,18,r.getPermissions()))}},dependencies:[b,E,y,q,K,L,$,R,v],encapsulation:2});let n=s;return n})();var Ze=[{path:"role-switching",component:Z},{path:"route-guard",component:ee,canActivate:[W],data:{permissions:{except:"GUEST",redirectTo:"/dashboard"}}},{path:"test",component:te,canActivate:[W],data:{permissions:{only:"ADMIN",redirectTo:"/dashboard"}}}];export{Ze as routes};
