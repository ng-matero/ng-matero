import{a as Q,b as X}from"./chunk-A7P4CNLL.js";import{a as D,b as j,c as F}from"./chunk-BIXNSCEY.js";import{b as v,d as y,j as E}from"./chunk-WSR6HQ5G.js";import{$a as p,Ab as g,Ca as w,Gb as h,Hb as P,M as U,Mb as Y,Pa as c,Pf as b,Qa as e,Qf as k,Ra as i,Rf as K,Sa as T,Sf as H,T as d,Te as N,Tf as q,W as _,X as f,Xe as I,Za as $,ag as R,bc as S,f as J,ff as G,kb as W,oa as o,pb as t,qb as u,tb as A,ub as C,vb as O,wa as x,xc as L}from"./chunk-KP6RUH3P.js";var z=class n{rolesSrv=d(k);permissionsSrv=d(b);currentRole="";currentPermissions=[];permissionsOfRole={ADMIN:["canAdd","canDelete","canEdit","canRead"],MANAGER:["canAdd","canEdit","canRead"],GUEST:["canRead"]};_destroy$=new J;ngOnInit(){this.currentRole=Object.keys(this.rolesSrv.getRoles())[0],this.currentPermissions=Object.keys(this.permissionsSrv.getPermissions()),this.rolesSrv.roles$.pipe(U(this._destroy$)).subscribe(r=>{console.log(r)}),this.permissionsSrv.permissions$.pipe(U(this._destroy$)).subscribe(r=>{console.log(r)})}ngOnDestroy(){this._destroy$.next(),this._destroy$.complete()}onPermissionChange(){this.currentPermissions=this.permissionsOfRole[this.currentRole],this.rolesSrv.flushRolesAndPermissions(),this.rolesSrv.addRoleWithPermissions(this.currentRole,this.currentPermissions)}static \u0275fac=function(a){return new(a||n)};static \u0275cmp=x({type:n,selectors:[["app-permissions-role-switching"]],decls:26,vars:7,consts:[["href","https://github.com/AlexKhymenko/ngx-permissions","target","_blank"],[3,"ngModelChange","change","ngModel"],["value","ADMIN"],["value","MANAGER"],["value","GUEST"]],template:function(a,s){a&1&&(T(0,"page-header"),e(1,"p"),t(2," The permissions management is powered by "),e(3,"a",0)(4,"code"),t(5,"ngx-permissions"),i()(),t(6,` .
`),i(),e(7,"mat-card")(8,"mat-card-content")(9,"mat-button-toggle-group",1),O("ngModelChange",function(m){return C(s.currentRole,m)||(s.currentRole=m),m}),p("change",function(){return s.onPermissionChange()}),e(10,"mat-button-toggle",2),t(11,"ADMIN"),i(),e(12,"mat-button-toggle",3),t(13,"MANAGER"),i(),e(14,"mat-button-toggle",4),t(15,"GUEST"),i()(),e(16,"p"),t(17," Your current role: "),e(18,"code"),t(19),h(20,"json"),i()(),e(21,"p"),t(22," Your current permissions: "),e(23,"code"),t(24),h(25,"json"),i()()()()),a&2&&(o(9),A("ngModel",s.currentRole),o(10),u(P(20,3,s.currentRole)),o(5),u(P(25,5,s.currentPermissions)))},dependencies:[G,N,I,F,D,j,E,v,y,R,S],encapsulation:2})};var B=class n{router=d(L);rolesSrv=d(k);permissionsSrv=d(b);currentRole="";currentPermissions=[];permissionsOfRole={ADMIN:["canAdd","canDelete","canEdit","canRead"],MANAGER:["canAdd","canEdit","canRead"],GUEST:["canRead"]};ngOnInit(){this.currentRole=Object.keys(this.rolesSrv.getRoles())[0],this.currentPermissions=Object.keys(this.permissionsSrv.getPermissions())}onPermissionChange(){this.currentPermissions=this.permissionsOfRole[this.currentRole],this.rolesSrv.flushRolesAndPermissions(),this.rolesSrv.addRoleWithPermissions(this.currentRole,this.currentPermissions),this.router.navigateByUrl("/dashboard")}static \u0275fac=function(a){return new(a||n)};static \u0275cmp=x({type:n,selectors:[["app-permissions-route-guard"]],decls:22,vars:7,consts:[[3,"ngModelChange","change","ngModel"],["value","ADMIN"],["value","MANAGER"],["value","GUEST"]],template:function(a,s){a&1&&(T(0,"page-header"),e(1,"p"),t(2,"The route will be redirected to dashboard after change permission."),i(),e(3,"mat-card")(4,"mat-card-content")(5,"mat-button-toggle-group",0),O("ngModelChange",function(m){return C(s.currentRole,m)||(s.currentRole=m),m}),p("change",function(){return s.onPermissionChange()}),e(6,"mat-button-toggle",1),t(7,"ADMIN"),i(),e(8,"mat-button-toggle",2),t(9,"MANAGER"),i(),e(10,"mat-button-toggle",3),t(11,"GUEST"),i()(),e(12,"p"),t(13," Your current role: "),e(14,"code"),t(15),h(16,"json"),i()(),e(17,"p"),t(18," Your current permissions: "),e(19,"code"),t(20),h(21,"json"),i()()()()),a&2&&(o(5),A("ngModel",s.currentRole),o(10),u(P(16,3,s.currentRole)),o(5),u(P(21,5,s.currentPermissions)))},dependencies:[G,N,I,F,D,j,E,v,y,R,S],encapsulation:2})};var M=()=>["admin"],se=()=>["guest"],re=()=>["adminnnnn"],oe=()=>[];function me(n,r){n&1&&(e(0,"p",11),t(1,"I should see it only admin"),i())}function ae(n,r){n&1&&(e(0,"p",11),t(1,"Usage on both only and except I should see it only admin"),i())}function le(n,r){n&1&&(e(0,"p",12),t(1,"I will see it only guest"),i())}function pe(n,r){n&1&&(e(0,"p",13),t(1,"I will see it except adminnnnn"),i())}function ce(n,r){n&1&&(e(0,"p",14),t(1,"I should see it except admin"),i())}function de(n,r){n&1&&(e(0,"div"),t(1,"Testing template"),i())}function ue(n,r){n&1&&(e(0,"div"),t(1,"Testing template"),i())}function ge(n,r){n&1&&(e(0,"p",15),t(1,"else block"),i())}function he(n,r){n&1&&(e(0,"p",16),t(1,"then block"),i())}function Pe(n,r){n&1&&(e(0,"button"),t(1," This should be visible to admin or superadmin "),i())}function _e(n,r){n&1&&(e(0,"button"),t(1,"WTF"),i())}var V=class n{permissionsSrv=d(b);comparedPermission=["guest"];getPermissions(){return Object.keys(this.permissionsSrv.getPermissions())}addPermission(){this.permissionsSrv.addPermission("admin",()=>new Promise((r,a)=>{setTimeout(()=>r(!0),2e3)}))}removePermission(){this.permissionsSrv.removePermission("admin")}unAuthorized(){console.log("unAuthorized")}authorized(){console.log("authorizes")}changeToAdmin(){this.comparedPermission=["admin"],console.log(this.comparedPermission)}changeToAnotherPermission(){this.comparedPermission=["awesome"],console.log(this.comparedPermission)}changeToGuest(){this.comparedPermission=["guest"],console.log(this.comparedPermission)}static \u0275fac=function(a){return new(a||n)};static \u0275cmp=x({type:n,selectors:[["app-permissions-test"]],decls:41,vars:28,consts:[["a",""],["b",""],["type","danger"],[3,"click"],["permissions","",3,"ngxPermissionsOnly"],[3,"ngxPermissionsOnly","ngxPermissionsExcept"],["permissions","",3,"permissionsAuthorized","permissionsUnauthorized","ngxPermissionsExcept"],["permissions","",3,"ngxPermissionsExcept"],[4,"ngxPermissionsOnly","ngxPermissionsOnlyElse","ngxPermissionsOnlyThen"],[4,"ngxPermissionsExcept","ngxPermissionsExceptElse","ngxPermissionsExceptThen"],[4,"ngxPermissionsOnly"],[1,"bg-green-50","text-white"],[1,"bg-purple-50","text-white"],[1,"bg-orange-50","text-white"],[1,"bg-azure-50","text-white"],[1,"bg-azure-30","text-light"],[1,"bg-azure-90","text-dark"]],template:function(a,s){if(a&1){let l=$();T(0,"page-header"),e(1,"mat-card")(2,"mat-card-content")(3,"mtx-alert",2),t(4,"\u26A0\uFE0F The permissions check will delay 2s."),i(),e(5,"p")(6,"button",3),p("click",function(){return _(l),f(s.addPermission())}),t(7,"Add Permission [ admin ]"),i(),e(8,"button",3),p("click",function(){return _(l),f(s.removePermission())}),t(9,"Remove Permission [ admin ]"),i()(),w(10,me,2,0,"ng-template",4)(11,ae,2,0,"ng-template",5)(12,le,2,0,"ng-template",4)(13,pe,2,0,"ng-template",6),p("permissionsAuthorized",function(){return _(l),f(s.authorized())})("permissionsUnauthorized",function(){return _(l),f(s.unAuthorized())}),w(14,ce,2,0,"ng-template",7)(15,de,2,0,"div",8)(16,ue,2,0,"div",9)(17,ge,2,0,"ng-template",null,0,Y)(19,he,2,0,"ng-template",null,1,Y),e(21,"p"),t(22," Compared permission: "),e(23,"code"),t(24),h(25,"json"),i()(),e(26,"div")(27,"button",3),p("click",function(){return _(l),f(s.changeToAdmin())}),t(28,"Change To Admin Permission"),i(),e(29,"button",3),p("click",function(){return _(l),f(s.changeToAnotherPermission())}),t(30,"Change To Awesome Permission"),i(),e(31,"button",3),p("click",function(){return _(l),f(s.changeToGuest())}),t(32,"Change To Guest Permission"),i()(),e(33,"div"),w(34,Pe,2,0,"button",10)(35,_e,2,0,"button",10),i(),e(36,"p"),t(37," Your current permissions: "),e(38,"code"),t(39),h(40,"json"),i()()()()}if(a&2){let l=W(18),m=W(20);o(10),c("ngxPermissionsOnly",g(20,M)),o(),c("ngxPermissionsOnly",g(21,M))("ngxPermissionsExcept","hhhhh"),o(),c("ngxPermissionsOnly",g(22,se)),o(),c("ngxPermissionsExcept",g(23,re)),o(),c("ngxPermissionsExcept",g(24,M)),o(),c("ngxPermissionsOnly",g(25,M))("ngxPermissionsOnlyElse",l)("ngxPermissionsOnlyThen",m),o(),c("ngxPermissionsExcept",g(26,M))("ngxPermissionsExceptElse",l)("ngxPermissionsExceptThen",m),o(8),u(P(25,16,s.comparedPermission)),o(10),c("ngxPermissionsOnly",s.comparedPermission),o(),c("ngxPermissionsOnly",g(27,oe)),o(4),u(P(40,18,s.getPermissions()))}},dependencies:[E,v,y,X,Q,q,K,R,S],encapsulation:2})};var it=[{path:"role-switching",component:z},{path:"route-guard",component:B,canActivate:[H],data:{permissions:{except:"GUEST",redirectTo:"/dashboard"}}},{path:"test",component:V,canActivate:[H],data:{permissions:{only:"ADMIN",redirectTo:"/dashboard"}}}];export{it as routes};
