import{a as K,b as q}from"./chunk-GXKX5RVI.js";import{a as j,b as F,c as z}from"./chunk-ZYBCJJLB.js";import{b as C,d as E,j as y}from"./chunk-GPAZGZBE.js";import{Ac as L,Lc as M,Sb as N,Yb as k,hc as I,q as J,wc as b,xc as D,yc as $,zc as W}from"./chunk-Y3TE4HCF.js";import{Ca as x,Da as f,Ec as V,Fc as t,Gc as g,Jb as T,Jc as A,Kc as O,Lc as G,Nc as h,Qb as w,Tc as _,Uc as P,Xb as d,Zc as U,ga as B,ic as e,jc as n,kc as S,n as Y,oc as H,ra as u,rc as p,ub as s,zd as v}from"./chunk-CDJ2EF3V.js";var Z=(()=>{class i{constructor(){this.rolesSrv=u(D),this.permissionsSrv=u(b),this.currentRole="",this.currentPermissions=[],this.permissionsOfRole={ADMIN:["canAdd","canDelete","canEdit","canRead"],MANAGER:["canAdd","canEdit","canRead"],GUEST:["canRead"]},this._destroy$=new Y}ngOnInit(){this.currentRole=Object.keys(this.rolesSrv.getRoles())[0],this.currentPermissions=Object.keys(this.permissionsSrv.getPermissions()),this.rolesSrv.roles$.pipe(B(this._destroy$)).subscribe(l=>{console.log(l)}),this.permissionsSrv.permissions$.pipe(B(this._destroy$)).subscribe(l=>{console.log(l)})}ngOnDestroy(){this._destroy$.next(),this._destroy$.complete()}onPermissionChange(){this.currentPermissions=this.permissionsOfRole[this.currentRole],this.rolesSrv.flushRolesAndPermissions(),this.rolesSrv.addRoleWithPermissions(this.currentRole,this.currentPermissions)}static{this.\u0275fac=function(m){return new(m||i)}}static{this.\u0275cmp=T({type:i,selectors:[["app-permissions-role-switching"]],decls:26,vars:7,consts:[["href","https://github.com/AlexKhymenko/ngx-permissions","target","_blank"],[3,"ngModelChange","change","ngModel"],["value","ADMIN"],["value","MANAGER"],["value","GUEST"]],template:function(m,o){m&1&&(S(0,"page-header"),e(1,"p"),t(2," The permissions management is powered by "),e(3,"a",0)(4,"code"),t(5,"ngx-permissions"),n()(),t(6,` .
`),n(),e(7,"mat-card")(8,"mat-card-content")(9,"mat-button-toggle-group",1),G("ngModelChange",function(r){return O(o.currentRole,r)||(o.currentRole=r),r}),p("change",function(){return o.onPermissionChange()}),e(10,"mat-button-toggle",2),t(11,"ADMIN"),n(),e(12,"mat-button-toggle",3),t(13,"MANAGER"),n(),e(14,"mat-button-toggle",4),t(15,"GUEST"),n()(),e(16,"p"),t(17," Your current role: "),e(18,"code"),t(19),_(20,"json"),n()(),e(21,"p"),t(22," Your current permissions: "),e(23,"code"),t(24),_(25,"json"),n()()()()),m&2&&(s(9),A("ngModel",o.currentRole),s(10),g(P(20,3,o.currentRole)),s(5),g(P(25,5,o.currentPermissions)))},dependencies:[v,I,N,k,z,j,F,y,C,E,M],encapsulation:2})}}return i})();var ee=(()=>{class i{constructor(){this.router=u(J),this.rolesSrv=u(D),this.permissionsSrv=u(b),this.currentRole="",this.currentPermissions=[],this.permissionsOfRole={ADMIN:["canAdd","canDelete","canEdit","canRead"],MANAGER:["canAdd","canEdit","canRead"],GUEST:["canRead"]}}ngOnInit(){this.currentRole=Object.keys(this.rolesSrv.getRoles())[0],this.currentPermissions=Object.keys(this.permissionsSrv.getPermissions())}onPermissionChange(){this.currentPermissions=this.permissionsOfRole[this.currentRole],this.rolesSrv.flushRolesAndPermissions(),this.rolesSrv.addRoleWithPermissions(this.currentRole,this.currentPermissions),this.router.navigateByUrl("/dashboard")}static{this.\u0275fac=function(m){return new(m||i)}}static{this.\u0275cmp=T({type:i,selectors:[["app-permissions-route-guard"]],decls:22,vars:7,consts:[[3,"ngModelChange","change","ngModel"],["value","ADMIN"],["value","MANAGER"],["value","GUEST"]],template:function(m,o){m&1&&(S(0,"page-header"),e(1,"p"),t(2,"The route will be redirected to dashboard after change permission."),n(),e(3,"mat-card")(4,"mat-card-content")(5,"mat-button-toggle-group",0),G("ngModelChange",function(r){return O(o.currentRole,r)||(o.currentRole=r),r}),p("change",function(){return o.onPermissionChange()}),e(6,"mat-button-toggle",1),t(7,"ADMIN"),n(),e(8,"mat-button-toggle",2),t(9,"MANAGER"),n(),e(10,"mat-button-toggle",3),t(11,"GUEST"),n()(),e(12,"p"),t(13," Your current role: "),e(14,"code"),t(15),_(16,"json"),n()(),e(17,"p"),t(18," Your current permissions: "),e(19,"code"),t(20),_(21,"json"),n()()()()),m&2&&(s(5),A("ngModel",o.currentRole),s(10),g(P(16,3,o.currentRole)),s(5),g(P(21,5,o.currentPermissions)))},dependencies:[v,I,N,k,z,j,F,y,C,E,M],encapsulation:2})}}return i})();var R=()=>["admin"],oe=()=>["guest"],se=()=>["adminnnnn"],re=()=>[];function me(i,c){i&1&&(e(0,"p",11),t(1,"I should see it only admin"),n())}function ae(i,c){i&1&&(e(0,"p",11),t(1,"Usage on both only and except I should see it only admin"),n())}function le(i,c){i&1&&(e(0,"p",12),t(1,"I will see it only guest"),n())}function pe(i,c){i&1&&(e(0,"p",13),t(1,"I will see it except adminnnnn"),n())}function ce(i,c){i&1&&(e(0,"p",14),t(1,"I should see it except admin"),n())}function de(i,c){i&1&&(e(0,"div"),t(1,"Testing template"),n())}function ue(i,c){i&1&&(e(0,"div"),t(1,"Testing template"),n())}function ge(i,c){i&1&&(e(0,"p",15),t(1,"else block"),n())}function he(i,c){i&1&&(e(0,"p",16),t(1,"then block"),n())}function _e(i,c){i&1&&(e(0,"button"),t(1," This should be visible to admin or superadmin "),n())}function Pe(i,c){i&1&&(e(0,"button"),t(1,"WTF"),n())}var te=(()=>{class i{constructor(){this.permissionsSrv=u(b),this.comparedPermission=["guest"]}getPermissions(){return Object.keys(this.permissionsSrv.getPermissions())}addPermission(){this.permissionsSrv.addPermission("admin",()=>new Promise((l,m)=>{setTimeout(()=>l(!0),2e3)}))}removePermission(){this.permissionsSrv.removePermission("admin")}unAuthorized(){console.log("unAuthorized")}authorized(){console.log("authorizes")}changeToAdmin(){this.comparedPermission=["admin"],console.log(this.comparedPermission)}changeToAnotherPermission(){this.comparedPermission=["awesome"],console.log(this.comparedPermission)}changeToGuest(){this.comparedPermission=["guest"],console.log(this.comparedPermission)}static{this.\u0275fac=function(m){return new(m||i)}}static{this.\u0275cmp=T({type:i,selectors:[["app-permissions-test"]],decls:41,vars:28,consts:[["a",""],["b",""],["type","danger"],[3,"click"],["permissions","",3,"ngxPermissionsOnly"],[3,"ngxPermissionsOnly","ngxPermissionsExcept"],["permissions","",3,"permissionsAuthorized","permissionsUnauthorized","ngxPermissionsExcept"],["permissions","",3,"ngxPermissionsExcept"],[4,"ngxPermissionsOnly","ngxPermissionsOnlyElse","ngxPermissionsOnlyThen"],[4,"ngxPermissionsExcept","ngxPermissionsExceptElse","ngxPermissionsExceptThen"],[4,"ngxPermissionsOnly"],[1,"bg-green-50","text-white"],[1,"bg-purple-50","text-white"],[1,"bg-orange-50","text-white"],[1,"bg-azure-50","text-white"],[1,"bg-azure-30","text-light"],[1,"bg-azure-90","text-dark"]],template:function(m,o){if(m&1){let a=H();S(0,"page-header"),e(1,"mat-card")(2,"mat-card-content")(3,"mtx-alert",2),t(4,"\u26A0\uFE0F The permissions check will delay 2s."),n(),e(5,"p")(6,"button",3),p("click",function(){return x(a),f(o.addPermission())}),t(7,"Add Permission [ admin ]"),n(),e(8,"button",3),p("click",function(){return x(a),f(o.removePermission())}),t(9,"Remove Permission [ admin ]"),n()(),w(10,me,2,0,"ng-template",4)(11,ae,2,0,"ng-template",5)(12,le,2,0,"ng-template",4)(13,pe,2,0,"ng-template",6),p("permissionsAuthorized",function(){return x(a),f(o.authorized())})("permissionsUnauthorized",function(){return x(a),f(o.unAuthorized())}),w(14,ce,2,0,"ng-template",7)(15,de,2,0,"div",8)(16,ue,2,0,"div",9)(17,ge,2,0,"ng-template",null,0,U)(19,he,2,0,"ng-template",null,1,U),e(21,"p"),t(22," Compared permission: "),e(23,"code"),t(24),_(25,"json"),n()(),e(26,"div")(27,"button",3),p("click",function(){return x(a),f(o.changeToAdmin())}),t(28,"Change To Admin Permission"),n(),e(29,"button",3),p("click",function(){return x(a),f(o.changeToAnotherPermission())}),t(30,"Change To Awesome Permission"),n(),e(31,"button",3),p("click",function(){return x(a),f(o.changeToGuest())}),t(32,"Change To Guest Permission"),n()(),e(33,"div"),w(34,_e,2,0,"button",10)(35,Pe,2,0,"button",10),n(),e(36,"p"),t(37," Your current permissions: "),e(38,"code"),t(39),_(40,"json"),n()()()()}if(m&2){let a=V(18),r=V(20);s(10),d("ngxPermissionsOnly",h(20,R)),s(),d("ngxPermissionsOnly",h(21,R))("ngxPermissionsExcept","hhhhh"),s(),d("ngxPermissionsOnly",h(22,oe)),s(),d("ngxPermissionsExcept",h(23,se)),s(),d("ngxPermissionsExcept",h(24,R)),s(),d("ngxPermissionsOnly",h(25,R))("ngxPermissionsOnlyElse",a)("ngxPermissionsOnlyThen",r),s(),d("ngxPermissionsExcept",h(26,R))("ngxPermissionsExceptElse",a)("ngxPermissionsExceptThen",r),s(8),g(P(25,16,o.comparedPermission)),s(10),d("ngxPermissionsOnly",o.comparedPermission),s(),d("ngxPermissionsOnly",h(27,re)),s(4),g(P(40,18,o.getPermissions()))}},dependencies:[v,y,C,E,q,K,L,$,M],encapsulation:2})}}return i})();var Ze=[{path:"role-switching",component:Z},{path:"route-guard",component:ee,canActivate:[W],data:{permissions:{except:"GUEST",redirectTo:"/dashboard"}}},{path:"test",component:te,canActivate:[W],data:{permissions:{only:"ADMIN",redirectTo:"/dashboard"}}}];export{Ze as routes};
